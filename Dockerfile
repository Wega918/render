# 1. Используем официальный образ PHP с веб-сервером Apache
FROM php:8.2-apache

# 2. Устанавливаем корневую директорию сервера
WORKDIR /var/www/html

# 3. Копируем ваш скрипт-прокси в корень веб-сервера
# (Убедитесь, что имя файла в репозитории совпадает!)
COPY gemini_proxy_external.php .

# 4. Включаем модуль mod_rewrite (для чистоты, хотя здесь он не обязателен)
RUN a2enmod rewrite

# 5. Устанавливаем лимит на память для PHP, чтобы избежать ошибок при больших ответах
RUN echo "memory_limit = 256M" > /usr/local/etc/php/conf.d/render-php.ini

# 6. Apache по умолчанию слушает порт 80, Render будет использовать его.
EXPOSE 80
